# AIPOS ALE 产品宪章

> **Agentic Low-code Engineering Platform**  
> 版本：2.0 | 生效日期：2025年12月  
> 对标：Palantir Foundry/AIP 本体工程

---

## 第一章：产品愿景与使命

### 1.1 产品愿景

**构建企业级「语义操作系统」**：让业务知识成为可执行的资产，让智能体在治理框架下安全、可控、可审计地自主运行。

### 1.2 产品使命

- **彻底变革交互模式**：从传统「配置式低代码」转向「意图理解 + 响应式动态视图」的 AI 原生模式
- **降低智能化门槛**：让业务专家用自然语言表达需求，AI 自动转换为可执行的本体和规则
- **保障可控可信**：通过门禁机制（Gates）确保每一次变更和执行都经过验证
- **实现闭环价值**：从意图理解到执行落地，形成完整的业务闭环

### 1.3 核心架构：双态分离

```
┌─────────────────────────────────────────────────────────────────────────┐
│                          ALE 双态架构                                    │
├─────────────────────────────────┬───────────────────────────────────────┤
│      构建态 (Design Time)        │        运行态 (Runtime)               │
│      「AI 原生交互」              │        「本体驱动执行」                │
├─────────────────────────────────┼───────────────────────────────────────┤
│  • 自然语言意图表达              │  • 结构化 API 调用                     │
│  • 意图理解引擎                  │  • 门禁引擎 (G1-G7)                    │
│  • 响应式动态视图                │  • 确定性动作执行                      │
│  • ChangeSet 生成                │  • 事件记录 + 证据                     │
├─────────────────────────────────┼───────────────────────────────────────┤
│  用户：设计者、分析师            │  用户：操作员、系统、智能体            │
│  目标：定义「是什么」            │  目标：执行「做什么」                  │
│  产物：本体、规则、视图          │  产物：数据变更、事件、证据            │
└─────────────────────────────────┴───────────────────────────────────────┘
```

**为什么必须分离？**
- **构建态**需要创造性、探索性、迭代性 → 适合 AI 辅助的自然语言交互
- **运行态**需要确定性、高性能、可审计 → 适合本体驱动的结构化执行

### 1.3 北极星指标

| 指标类别 | 核心指标 | 目标值 | 衡量方式 |
|---------|---------|-------|---------|
| **效率** | 场景上线周期 | ≤2周（传统4-8周） | 从需求到生产的时间 |
| **质量** | 门禁通过率 | ≥95%（首次提交） | G1-G7 通过率 |
| **可控** | 变更回滚率 | ≤2% | 发布后回滚的比例 |
| **信任** | 智能体自主执行率 | 60%→90%（渐进） | 无需人工审批的执行比例 |
| **覆盖** | 本体化业务域 | 年增≥5个核心域 | 纳入本体管理的业务域数量 |

---

## 第二章：核心产品原则

### 2.0 双态分离原则（Dual-Mode Separation）- 最高优先级

```
┌─────────────────────────────────────────────────────────────────────────┐
│                    产品原则 #0（最高优先级）                             │
│         「构建态 AI 原生，运行态本体驱动」                               │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  构建态：彻底重构 NocoBase 的交互模式                                    │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━   │
│  传统模式（废弃）:                                                       │
│    用户 → 点击菜单 → 填表单 → 配置选项 → 保存 → 生效                     │
│                                                                         │
│  AI 原生模式（新）:                                                      │
│    用户 → 表达意图 → AI 理解 → 动态预览 → 迭代调整 → 确认发布            │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━   │
│                                                                         │
│  运行态：本体驱动的确定性执行                                            │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━   │
│    请求 → 本体解析 → 门禁检查 → 动作执行 → 证据记录                       │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━   │
│                                                                         │
│  ✗ 禁止：运行态直接修改本体（必须回到构建态）                             │
│  ✗ 禁止：构建态使用传统配置式交互                                        │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 2.1 意图驱动设计（Intent-Driven Design）- 构建态核心

```
┌─────────────────────────────────────────────────────────────────────────┐
│                    产品原则 #1                                           │
│         「用户表达想要什么，而非如何配置」                                │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  示例对比：                                                              │
│                                                                         │
│  传统方式（5步操作）:                                                    │
│    1. 创建 Collection "处置单"                                          │
│    2. 添加字段：订单号(string)、状态(enum)、风险等级(enum)...            │
│    3. 配置关联：处置单 hasMany 证据                                      │
│    4. 配置工作流：状态机节点...                                          │
│    5. 配置 UI：列表页、表单页...                                         │
│                                                                         │
│  AI 原生方式（1次对话）:                                                 │
│    用户："我需要一个延迟订单处置流程，高风险的需要主管审批"               │
│    AI：自动生成全部定义，展示预览，用户确认即可                           │
│                                                                         │
│  ✓ 用业务语言，不需要理解技术概念                                        │
│  ✓ 一次表达复杂意图，无需拆解                                            │
│  ✓ AI 负责意图→技术的转换                                               │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 2.2 响应式动态视图（Reactive Dynamic View）- 构建态核心

```
┌─────────────────────────────────────────────────────────────────────────┐
│                    产品原则 #2                                           │
│         「即时反馈，所见即所得」                                          │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  ✓ 每次意图表达后立即更新预览视图                                        │
│  ✓ 多维度预览：                                                          │
│      • 对象结构视图（ER 图）                                             │
│      • 状态机视图（流程图）                                              │
│      • UI 效果预览（实际界面）                                           │
│      • 影响分析视图（受影响范围）                                        │
│  ✓ 预览可交互编辑，反向修改方案                                          │
│  ✓ 门禁预检结果实时展示                                                  │
│                                                                         │
│  ✗ 禁止：盲目确认（必须看到预览才能确认）                                │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 2.3 本体即控制（Ontology as Control Plane）- 运行态核心

```
┌─────────────────────────────────────────────────────────────────────────┐
│                    产品原则 #3                                           │
│         「本体不是文档，是运行时的控制层」                                │
├─────────────────────────────────────────────────────────────────────────┤
│  ✓ 对象/关系/行为的定义直接约束系统行为                                   │
│  ✓ 本体变更触发门禁评估，非直接生效                                       │
│  ✓ 版本化管理，支持回滚和差异比对                                         │
│  ✓ 运行态 UI/API 从本体自动生成                                          │
│  ✗ 禁止：绕过本体直接操作底层数据                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

**原则阐述**：
- 业务对象、关系、规则必须在本体层定义，不允许「影子对象」
- 所有 API、UI、工作流都从本体派生，确保一致性
- 本体是「单一事实来源」（Single Source of Truth）

### 2.4 变更即审计（Change as Audit Trail）

```
┌─────────────────────────────────────────────────────────────┐
│                    产品原则 #2                               │
│              「没有 ChangeSet，就没有变更」                    │
├─────────────────────────────────────────────────────────────┤
│  ✓ 所有变更必须通过 ChangeSet 提交                           │
│  ✓ ChangeSet 包含：变更内容、证据、门禁报告、审批链             │
│  ✓ 变更可追溯：谁、何时、为什么、改了什么、影响什么             │
│  ✗ 禁止：直接修改 Schema/配置/规则                            │
└─────────────────────────────────────────────────────────────┘
```

**实践要求**：
- 开发环境可放宽（警告模式），生产环境强制执行
- 紧急变更有「快速通道」但必须补录证据
- 所有变更保留完整历史，永不删除

### 2.3 门禁即信任（Gates as Trust）

```
┌─────────────────────────────────────────────────────────────┐
│                    产品原则 #3                               │
│             「通过门禁的才是可信的」                          │
├─────────────────────────────────────────────────────────────┤
│  G1 结构校验   → 数据格式正确                                 │
│  G3 证据校验   → 有充分依据                                   │
│  G6 执行校验   → 有权限、条件满足                              │
│  G7 评测校验   → 符合质量标准                                  │
├─────────────────────────────────────────────────────────────┤
│  门禁是「信任边界」：通过 = 可执行，未通过 = 需介入             │
└─────────────────────────────────────────────────────────────┘
```

**门禁策略**：
- MVP 阶段：G1/G3/G6/G7 必选，其他可选
- 高风险操作：必须通过全部门禁
- 门禁结果纳入决策，不仅仅是日志

### 2.4 执行即证据（Execution as Evidence）

```
┌─────────────────────────────────────────────────────────────┐
│                    产品原则 #4                               │
│            「每次执行都产生可追溯的证据」                      │
├─────────────────────────────────────────────────────────────┤
│  ✓ 动作执行记录：输入、输出、时间、执行者                      │
│  ✓ 决策依据记录：使用了哪些数据、规则、模型                    │
│  ✓ 异常记录：失败原因、补偿动作、人工介入                      │
│  ✗ 禁止：「静默执行」无任何记录的操作                          │
└─────────────────────────────────────────────────────────────┘
```

**证据要求**：
- 证据是「可引用的」：有 ID，可被其他对象关联
- 证据是「可验证的」：有来源、有置信度
- 证据支持「链式追溯」：从结果反推到原始依据

### 2.5 隔离即安全（Space as Security Boundary）

```
┌─────────────────────────────────────────────────────────────┐
│                    产品原则 #5                               │
│             「Space 是权限和数据的边界」                       │
├─────────────────────────────────────────────────────────────┤
│  ✓ 每个 Space 有独立的：本体视图、数据域、工具白名单            │
│  ✓ 跨 Space 访问需显式授权，遵循最小权限原则                   │
│  ✓ 敏感数据通过 Markings 标记，控制用途                       │
│  ✗ 禁止：Space 间的隐式数据共享                               │
└─────────────────────────────────────────────────────────────┘
```

---

## 第三章：产品边界定义

### 3.1 产品范围（In Scope）

| 能力域 | 包含内容 | 优先级 |
|-------|---------|-------|
| **本体管理** | 对象/关系/元数据定义、版本控制、DocGen | P0 |
| **行为注册** | Actions/Functions/Workflows 定义与管理 | P0 |
| **门禁引擎** | G1-G7 门禁实现、门禁报告、失败策略 | P0 |
| **变更管理** | ChangeSet 生命周期、审批路由、回滚 | P0 |
| **证据系统** | 证据采集、存储、关联、查询 | P0 |
| **低代码 UI** | 基于本体的 UI 生成、表单/列表/详情页 | P1 |
| **映射层** | Kinetic 数据映射、虚拟表、增量刷新 | P1 |
| **Space 隔离** | 多租户、权限域、跨域协作 | P1 |
| **Agent Studio** | 智能体配置、发布、监控 | P2 |
| **仿真沙箱** | Scenario What-If、影响分析 | P2 |
| **RAG 检索** | 本体增强的语义检索 | P2 |

### 3.2 产品边界（Out of Scope）

| 能力域 | 不包含原因 | 替代方案 |
|-------|----------|---------|
| **底层数据库管理** | 使用 NocoBase 现有能力 | 复用 @nocobase/database |
| **用户身份认证** | 使用现有 SSO/IAM | 集成企业 IAM |
| **BI 报表** | 非核心能力 | 集成第三方 BI |
| **ETL 工具** | 使用专业工具 | 集成 Airbyte/dbt |
| **模型训练** | 聚焦推理应用 | 对接 MLOps 平台 |

### 3.3 用户角色定义

```
┌─────────────────────────────────────────────────────────────┐
│                      用户角色矩阵                            │
├──────────────┬──────────────────────────────────────────────┤
│ 业务分析师    │ 定义业务对象、配置规则、审批变更               │
│ (Ontologist) │ 核心工具：本体设计器、规则编辑器                │
├──────────────┼──────────────────────────────────────────────┤
│ 操作员       │ 使用低代码 UI 处理业务、触发动作                │
│ (Operator)   │ 核心工具：工作台、处置单、审批页                │
├──────────────┼──────────────────────────────────────────────┤
│ 智能体管理员  │ 配置智能体、绑定工具、设置门禁                  │
│ (Agent Admin)│ 核心工具：Agent Studio、评测管理               │
├──────────────┼──────────────────────────────────────────────┤
│ 平台管理员    │ 管理 Space、权限、系统配置                     │
│ (Platform)   │ 核心工具：Space 管理、权限配置、审计查询        │
├──────────────┼──────────────────────────────────────────────┤
│ 开发者       │ 开发插件、扩展能力、集成外部系统                │
│ (Developer)  │ 核心工具：SDK、API 文档、CLI                   │
└──────────────┴──────────────────────────────────────────────┘
```

---

## 第四章：场景优先级

### 4.1 MVP 场景：延迟订单风险处置

**业务价值**：
- 减少人工处理时间 60%
- 降低处置风险（错误处置）80%
- 提高客户满意度

**场景流程**：
```
延迟订单识别 → 风险评估 → 方案生成 → 审批 → 执行 → 结案
     ↓              ↓          ↓        ↓       ↓
  [自动触发]    [模型推理]  [规则匹配]  [门禁]  [写回]
                   ↓          ↓        ↓       ↓
                [证据记录] [证据记录] [证据记录] [证据记录]
```

**验收标准**：
- [ ] 处置单对象定义完整，含证据/事件关联
- [ ] 状态机 6 个状态、8 个转换正常工作
- [ ] 4 个核心动作（分配/提交/审批/执行）通过门禁
- [ ] ChangeSet 流程端到端跑通
- [ ] 审计日志完整可查

### 4.2 后续场景路线图

| 阶段 | 场景 | 业务价值 | 技术价值 |
|-----|-----|---------|---------|
| P1 | 客户信用评估 | 风控自动化 | 验证模型 Function |
| P1 | 库存预警处理 | 供应链优化 | 验证 Kinetic 映射 |
| P2 | 智能客服路由 | 服务效率 | 验证 Agent Studio |
| P2 | 合同审核助手 | 法务效率 | 验证 RAG + 本体 |
| P3 | 多部门协同审批 | 流程优化 | 验证跨 Space |

---

## 第五章：成功标准

### 5.1 MVP 成功标准（6周）

| 类别 | 指标 | 目标 | 验收方式 |
|-----|-----|-----|---------|
| **功能完整** | 核心用例覆盖 | 100% | 场景测试通过 |
| **门禁有效** | G1/G3/G6/G7 拦截率 | >0（有拦截记录） | 日志分析 |
| **可追溯** | 操作审计覆盖 | 100% | 随机抽查可追溯 |
| **可回滚** | ChangeSet 回滚成功 | 100% | 回滚测试通过 |
| **性能** | 门禁评估延迟 | <500ms (P99) | 性能测试 |

### 5.2 P1 成功标准（3个月）

| 类别 | 指标 | 目标 | 验收方式 |
|-----|-----|-----|---------|
| **扩展性** | 新场景上线周期 | ≤2周 | 实际项目验证 |
| **稳定性** | 系统可用性 | ≥99.5% | 监控统计 |
| **采纳度** | 日活用户 | ≥50 | 产品统计 |
| **自动化** | 自动执行比例 | ≥40% | 执行日志分析 |

### 5.3 长期成功标准（12个月）

| 类别 | 指标 | 目标 |
|-----|-----|-----|
| **规模** | 管理对象数 | ≥100 个业务对象 |
| **覆盖** | 业务域覆盖 | ≥5 个核心业务域 |
| **信任** | 智能体自主率 | ≥70% |
| **效率** | 开发效率提升 | ≥3倍（对比传统开发） |

---

## 第六章：产品治理

### 6.1 变更管理委员会

| 角色 | 职责 | 决策权限 |
|-----|-----|---------|
| 产品负责人 | 产品方向、优先级 | 功能范围变更 |
| 技术负责人 | 架构决策、技术选型 | 技术方案变更 |
| 业务代表 | 业务需求、验收标准 | 业务规则变更 |
| 安全负责人 | 安全评审、合规 | 安全策略变更 |

### 6.2 版本发布策略

```
┌─────────────────────────────────────────────────────────────┐
│                      版本发布策略                            │
├─────────────────────────────────────────────────────────────┤
│  主版本 (X.0.0)  │ 重大功能、Breaking Changes │ 季度发布     │
│  次版本 (0.X.0)  │ 新功能、向后兼容          │ 月度发布     │
│  补丁版本 (0.0.X)│ Bug 修复、安全补丁        │ 按需发布     │
├─────────────────────────────────────────────────────────────┤
│  预发布流程：Dev → Staging → Canary (10%) → Production      │
│  回滚策略：保留最近 3 个版本的回滚能力                        │
└─────────────────────────────────────────────────────────────┘
```

### 6.3 文档要求

| 文档类型 | 更新频率 | 负责人 |
|---------|---------|-------|
| 产品宪章 | 季度审阅 | 产品负责人 |
| 技术宪章 | 季度审阅 | 技术负责人 |
| API 文档 | 随代码更新 | 开发团队 |
| 用户手册 | 版本发布时 | 产品团队 |
| 运维手册 | 架构变更时 | SRE 团队 |

---

## 第七章：风险与约束

### 7.1 产品风险

| 风险 | 影响 | 概率 | 缓解措施 |
|-----|-----|-----|---------|
| 用户接受度低 | 高 | 中 | 渐进推广、培训支持、快速迭代 |
| 门禁过于严格影响效率 | 中 | 高 | 可配置门禁策略、快速通道 |
| 本体建模复杂度高 | 中 | 中 | 模板库、生成工具、专家支持 |
| 与现有系统集成困难 | 中 | 中 | 标准化接口、适配器模式 |

### 7.2 约束条件

| 约束类型 | 约束内容 | 应对策略 |
|---------|---------|---------|
| **技术约束** | 基于 NocoBase 1.8.x | 插件化扩展，不改内核 |
| **资源约束** | 初期团队 4-6 人 | 聚焦 MVP，渐进扩展 |
| **时间约束** | MVP 6 周交付 | 范围控制，迭代优化 |
| **合规约束** | 数据安全、隐私保护 | 内置审计、权限隔离 |

---

## 附录 A：术语表

| 术语 | 定义 |
|-----|-----|
| **Ontology（本体）** | 业务对象、关系、行为、规则的语义化定义 |
| **Space（空间）** | 权限隔离的业务域，包含本体视图和数据边界 |
| **ChangeSet（变更集）** | 一组相关变更的原子单元，包含变更内容和元数据 |
| **Gate（门禁）** | 变更或执行前的检查点，验证合规性 |
| **Evidence（证据）** | 支持决策的可追溯依据 |
| **Action（动作）** | 可执行的业务操作，具有强契约 |
| **Function（函数）** | 可复用的计算逻辑单元 |
| **Kinetic（映射）** | 数据源到本体的投影映射 |

---

**文档状态**：生效  
**下次审阅**：2026年3月  
**文档所有者**：产品委员会
